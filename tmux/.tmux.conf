
# ---------------------------------------------------
# GENERAL SETTINGS
# ---------------------------------------------------
# Enable mouse support (allows resizing panes and selecting text)
set -g mouse on

# ---------------------------------------------------
# VIM-STYLE PANE NAVIGATION
# ---------------------------------------------------
# Use h, j, k, l to move between panes
bind h select-pane -L
bind j select-pane -D
bind k select-pane -U
bind l select-pane -R

# ---------------------------------------------------
# PANE RESIZING
# ---------------------------------------------------
# Resize panes using PREFIX + H/J/K/L (Vim style)
# The '-r' flag allows you to hold the key to repeat
bind -r H resize-pane -L 5
bind -r J resize-pane -D 5
bind -r K resize-pane -U 5
bind -r L resize-pane -R 5

# ---------------------------------------------------
# COPY MODE
# ---------------------------------------------------
# Use Vim keybindings in copy mode
setw -g mode-keys vi

# Setup 'v' to begin selection as in Vim
bind-key -T copy-mode-vi v send-keys -X begin-selection

# ---------------------------------------------------
# 0x96f THEME COLORS (Manual Override)
# ---------------------------------------------------
# Base colors based on 0x96f image
set -g @thm_bg "#222222"
set -g @thm_fg "#ebdbb2"
set -g @thm_overlay_0 "#444444"
set -g @thm_white "#ffffff"

# Accents
set -g @thm_red "#ff6e67"
set -g @thm_green "#5af78e"
set -g @thm_yellow "#f3f99d"
set -g @thm_blue "#57c7ff"
set -g @thm_magenta "#ff6ac1"
set -g @thm_cyan "#9aedfe"

# Logical mappings
set -g @thm_peach "#{@thm_yellow}"
set -g @thm_maroon "#{@thm_red}"
set -g @thm_mauve "#{@thm_magenta}"
set -g @thm_pink "#{@thm_magenta}"
set -g @thm_rosewater "#{@thm_cyan}"

# ---------------------------------------------------
# PLUGINS
# ---------------------------------------------------
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-online-status'
set -g @plugin 'tmux-plugins/tmux-battery'

# Configure Online
set -g @online_icon "ok"
set -g @offline_icon "nok"

# Configure Battery Icons (Nerd Fonts)
set -g @batt_icon_charge_tier8 '󰁹'
set -g @batt_icon_charge_tier7 '󰂂'
set -g @batt_icon_charge_tier6 '󰂁'
set -g @batt_icon_charge_tier5 '󰂀'
set -g @batt_icon_charge_tier4 '󰁿'
set -g @batt_icon_charge_tier3 '󰁾'
set -g @batt_icon_charge_tier2 '󰁽'
set -g @batt_icon_charge_tier1 '󰁼'
set -g @batt_icon_status_charged '󰁹'
set -g @batt_icon_status_charging '󰂄'
set -g @batt_icon_status_discharging '󰂃'
set -g @batt_icon_status_attached '󰂄'
set -g @batt_icon_status_unknown '󰂑'

# ---------------------------------------------------
# STATUS BAR & VISUALS
# ---------------------------------------------------
# Configure Tmux Status Bar Positioning
set -g status-position top
set -g status-style "bg=default"
set -g status-justify "absolute-centre"

# Pane Border Look and Feel
setw -g pane-border-status top
setw -g pane-border-format ""

# Active Pane: Highlighted with 'Peach' (0x96f Yellow)
setw -g pane-active-border-style "bg=default,fg=#{@thm_peach}"

# Inactive Pane: Set fg to default/bg to make lines 'transparent'
setw -g pane-border-style "bg=default,fg=default"

setw -g pane-border-lines single

# Window Look and Feel
set -wg automatic-rename on
set -g automatic-rename-format "Window"

# --- FIXED SECTION START ---
# We force specific colors inside the format strings.

# Inactive Window: Uses 'overlay_0' (Dark Grey) to appear dimmed
set -g window-status-format "#[bg=default,fg=#{@thm_overlay_0}] #I#{?#{!=:#{window_name},Window},: #W,} "

# Active Window: Uses 'white' and bold to stand out
set -g window-status-current-format "#[bg=default,fg=#{@thm_white},bold] #I#{?#{!=:#{window_name},Window},: #W,} "

# Reset global styles to avoid conflicts
set -g window-status-style "bg=default,fg=default"
set -g window-status-current-style "bg=default,fg=default"
set -g window-status-activity-style "bg=#{@thm_red},fg=#{@thm_bg}"
set -g window-status-bell-style "bg=#{@thm_red},fg=#{@thm_bg},bold"
set -gF window-status-separator "#[bg=default,fg=#{@thm_overlay_0}]│"
# --- FIXED SECTION END ---

# Status Left Look and Feel
set -g status-left-length 100
set -g status-left ""
set -ga status-left "#{?client_prefix,#{#[bg=#{@thm_red},fg=#{@thm_bg},bold]  #S },#{#[bg=default,fg=#{@thm_green}]  #S }}"
set -ga status-left "#[bg=default,fg=#{@thm_overlay_0},none]│"
set -ga status-left "#[bg=default,fg=#{@thm_white}]  #{pane_current_command} "
set -ga status-left "#[bg=default,fg=#{@thm_overlay_0},none]│"
set -ga status-left "#[bg=default,fg=#{@thm_blue}]  #{=/-32/...:#{s|$USER|~|:#{b:pane_current_path}}} "
set -ga status-left "#[bg=default,fg=#{@thm_overlay_0},none]#{?window_zoomed_flag,│,}"
set -ga status-left "#[bg=default,fg=#{@thm_yellow}]#{?window_zoomed_flag,  zoom ,}"

# Status Right Look and Feel
set -g status-right-length 100
set -g status-right ""
set -ga status-right "#{?#{e|>=:10,#{battery_percentage}},#{#[bg=default,fg=#{@thm_pink}]},#{#[bg=#{@thm_red},fg=#{@thm_bg}]}} #{battery_icon} #{battery_percentage} "
set -ga status-right "#[bg=default,fg=#{@thm_overlay_0}, none]│"
set -ga status-right "#[bg=default]#{?#{==:#{online_status},ok},#[fg=#{@thm_white}] 󰖩 on ,#[fg=#{@thm_red},bold]#[reverse] 󰖪 off }"
set -ga status-right "#[bg=default,fg=#{@thm_overlay_0}, none]│"
set -ga status-right "#[bg=default,fg=#{@thm_blue}] 󰭦 %Y-%m-%d 󰅐 %H:%M "

# ---------------------------------------------------
# INITIALIZATION
# ---------------------------------------------------
# Bootstrap tpm
if "test ! -d ~/.tmux/plugins/tpm" \
   "run 'git clone https://github.com/tmux-plugins/tpm ~/.tmux/plugins/tpm && ~/.tmux/plugins/tpm/bin/install_plugins'"

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run '~/.tmux/plugins/tpm/tpm'
